# Copilot Agent TUI å®¢æˆ·ç«¯

äº¤äº’å¼ç»ˆç«¯ç”¨æˆ·ç•Œé¢ï¼Œç”¨äºéªŒè¯å’Œä½¿ç”¨ bambooã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… **å®æ—¶èŠå¤©ç•Œé¢** - ç¾è§‚çš„ç»ˆç«¯ UIï¼ŒåŸºäº ratatui
- âœ… **æµå¼æ¶ˆæ¯æ˜¾ç¤º** - SSE äº‹ä»¶å®æ—¶æ›´æ–°ï¼Œæ‰“å­—æœºæ•ˆæœ
- âœ… **å·¥å…·è°ƒç”¨å¯è§†åŒ–** - â³/âœ…/âŒ çŠ¶æ€æŒ‡ç¤ºå™¨
- âœ… **ä¼šè¯ç®¡ç†** - æ–°å»ºä¼šè¯ã€æŸ¥çœ‹å†å²
- âœ… **å¿«æ·é”®æ”¯æŒ** - å®Œæ•´çš„é”®ç›˜æ§åˆ¶
- âœ… **è¿æ¥çŠ¶æ€æ˜¾ç¤º** - å®æ—¶æ˜¾ç¤ºæœåŠ¡å™¨è¿æ¥çŠ¶æ€

## ç•Œé¢æˆªå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– Copilot Agent TUI                    Status: â— Connectedâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€ Messages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚                                                    â”‚     â”‚
â”‚ â”‚ ğŸ‘¤ è¯·è¯»å– /tmp/test.txt                           â”‚     â”‚
â”‚ â”‚                                                    â”‚     â”‚
â”‚ â”‚ ğŸ¤– æˆ‘æ¥å¸®ä½ è¯»å–æ–‡ä»¶å†…å®¹â–Œ                     [14:32:01]â”‚
â”‚ â”‚                                                    â”‚     â”‚
â”‚ â”‚   â³ read_file: Running...                        â”‚     â”‚
â”‚ â”‚   âœ… read_file: Hello World!                      â”‚     â”‚
â”‚ â”‚                                                    â”‚     â”‚
â”‚ â”‚ ğŸ¤– æ–‡ä»¶å†…å®¹æ˜¯ "Hello World!"                 [14:32:03]â”‚
â”‚ â”‚                                                    â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚ â”Œâ”€ Input â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚ >                                                 â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚  Messages: 3 | Scroll: 0 | [Enter] Send | [Ctrl+C] Quit    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä½¿ç”¨æ–¹æ³•

### 1. å¯åŠ¨ Agent Server

```bash
cd ~/workspace/copilot_client_app/crates/bamboo
./target/release/bamboo-server --port 8081
```

### 2. å¯åŠ¨ TUI å®¢æˆ·ç«¯

```bash
./target/release/bamboo-tui
```

TUI ä¼šè‡ªåŠ¨æ£€æµ‹æœåŠ¡å™¨è¿æ¥çŠ¶æ€ã€‚

## å¿«æ·é”®

| å¿«æ·é”® | åŠŸèƒ½ |
|--------|------|
| `Type` | è¾“å…¥æ¶ˆæ¯ |
| `Enter` | å‘é€æ¶ˆæ¯ |
| `Ctrl+S` | åœæ­¢ç”Ÿæˆ |
| `Ctrl+N` | æ–°å»ºä¼šè¯ |
| `Ctrl+L` | æ¸…ç©ºæ¶ˆæ¯ |
| `â†‘/â†“` | æ»šåŠ¨æ¶ˆæ¯ |
| `PgUp/PgDn` | ç¿»é¡µ |
| `Ctrl+C` | é€€å‡º |

## é¡¹ç›®ç»“æ„

```
crates/bamboo-tui/
â”œâ”€â”€ Cargo.toml
â””â”€â”€ src/
    â”œâ”€â”€ main.rs      # å…¥å£å’Œäº‹ä»¶å¾ªç¯
    â”œâ”€â”€ app.rs       # åº”ç”¨çŠ¶æ€ç®¡ç†
    â”œâ”€â”€ client.rs    # HTTP/SSE å®¢æˆ·ç«¯
    â”œâ”€â”€ ui.rs        # TUI æ¸²æŸ“
    â””â”€â”€ components/  # UI ç»„ä»¶
```

## æ–‡ä»¶è¯´æ˜

### main.rs
- ç»ˆç«¯åˆå§‹åŒ–å’Œæ¢å¤
- ä¸»äº‹ä»¶å¾ªç¯ï¼ˆé”®ç›˜äº‹ä»¶ + SSE äº‹ä»¶ï¼‰
- æ¯ 100ms åˆ·æ–° UI

### app.rs
- `App` ç»“æ„ä½“ï¼šç®¡ç†åº”ç”¨çŠ¶æ€
- `Message` ç»“æ„ä½“ï¼šèŠå¤©æ¶ˆæ¯
- `ToolCallInfo` ç»“æ„ä½“ï¼šå·¥å…·è°ƒç”¨çŠ¶æ€
- æ¶ˆæ¯ç®¡ç†å’Œæ»šåŠ¨æ§åˆ¶

### client.rs
- `AgentClient`ï¼šHTTP å®¢æˆ·ç«¯
- SSE æµè§£æ
- AgentEvent äº‹ä»¶ç±»å‹å®šä¹‰

### ui.rs
- ä½¿ç”¨ ratatui ç»˜åˆ¶ç•Œé¢
- æ¶ˆæ¯åˆ—è¡¨æ¸²æŸ“
- è¾“å…¥æ¡†å’ŒçŠ¶æ€æ 

## æ„å»º

```bash
cd ~/workspace/copilot_client_app/crates/bamboo
cargo build --release -p bamboo-tui
```

## ä¾èµ–

- **ratatui** - Rust TUI æ¡†æ¶
- **crossterm** - è·¨å¹³å°ç»ˆç«¯æ§åˆ¶
- **tokio** - å¼‚æ­¥è¿è¡Œæ—¶
- **reqwest** - HTTP å®¢æˆ·ç«¯
- **eventsource-stream** - SSE æµè§£æ

## æµ‹è¯•

1. ç¡®ä¿ Agent Server è¿è¡Œåœ¨ localhost:8081
2. è¿è¡Œ TUIï¼š`./target/release/bamboo-tui`
3. è¾“å…¥æ¶ˆæ¯å¹¶æŒ‰ Enter å‘é€
4. è§‚å¯Ÿæµå¼å“åº”å’Œå·¥å…·è°ƒç”¨

## ç‰¹æ€§

- ğŸ¨ **ç¾è§‚çš„ UI** - ä½¿ç”¨ ratatui çš„ç°ä»£ç»ˆç«¯ç•Œé¢
- âš¡ **å®æ—¶æ›´æ–°** - SSE æµå¼å“åº”ï¼Œå³æ—¶æ˜¾ç¤º
- ğŸ”§ **å·¥å…·å¯è§†åŒ–** - æ¸…æ™°æ˜¾ç¤ºå·¥å…·è°ƒç”¨çŠ¶æ€
- ğŸ“œ **ä¼šè¯ç®¡ç†** - æ”¯æŒå¤šä¼šè¯åˆ‡æ¢
- ğŸ’¾ **æ¶ˆæ¯å†å²** - æ»šåŠ¨æŸ¥çœ‹å®Œæ•´å¯¹è¯
