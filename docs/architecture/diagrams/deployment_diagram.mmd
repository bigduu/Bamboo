graph TB
    %% Ê†∑ÂºèÂÆö‰πâ
    classDef dev fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    classDef prod fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    classDef external fill:#ffebee,stroke:#c62828,stroke-width:2px
    classDef client fill:#e3f2fd,stroke:#1565c0,stroke-width:2px

    %% ÂºÄÂèëÁéØÂ¢ÉÈÉ®ÁΩ≤
    subgraph DevEnv["üñ•Ô∏è ÂºÄÂèëÁéØÂ¢É"]
        subgraph DevMachine["ÂºÄÂèëÊú∫Âô®"]
            DevCLI["bamboo-cli\nÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑"]
            DevTUI["bamboo-tui\nÁªàÁ´ØUI"]
            DevServer["bamboo-server\nHTTPÊúçÂä°:8081"]
            DevGateway["Gateway\nWebSocket:18790"]
            
            subgraph DevInternal["ÂÜÖÈÉ®ÁªÑ‰ª∂"]
                DevEventBus["EventBus"]
                DevAgent["AgentRunner"]
                DevLLM["LLM Provider"]
                DevSkill["Skill Manager"]
                DevTool["Tool Executor"]
            end
            
            subgraph DevStorage["Êú¨Âú∞Â≠òÂÇ®"]
                DevConfig["~/.bamboo/\nconfig.json"]
                DevSessions["~/.bamboo/\nsessions/"]
                DevSkills["~/.bamboo/\nskills/"]
                DevLogs["~/.bamboo/\nlogs/"]
            end
        end
        
        DevLocalLLM["Êú¨Âú∞LLM\nOllama/LM Studio\n:11434/:1234"]
    end

    %% Áîü‰∫ßÁéØÂ¢ÉÈÉ®ÁΩ≤
    subgraph ProdEnv["üåê Áîü‰∫ßÁéØÂ¢É"]
        subgraph LoadBalancer["Ë¥üËΩΩÂùáË°°Â±Ç"]
            Nginx["Nginx/Traefik\nÂèçÂêë‰ª£ÁêÜ"]
        end
        
        subgraph AppServers["Â∫îÁî®ÊúçÂä°Âô®ÈõÜÁæ§"]
            Server1["bamboo-server-1\n:8081"]
            Server2["bamboo-server-2\n:8081"]
            ServerN["bamboo-server-N\n:8081"]
        end
        
        subgraph SharedStorage["ÂÖ±‰∫´Â≠òÂÇ®"]
            Postgres[("PostgreSQL\n‰ºöËØùÊåÅ‰πÖÂåñ")]
            Redis[("Redis\nÁºìÂ≠ò/Ê∂àÊÅØÈòüÂàó")]
            ObjectStorage["ÂØπË±°Â≠òÂÇ®\nSkillÊñá‰ª∂"]
        end
        
        subgraph ExternalServices["Â§ñÈÉ®ÊúçÂä°"]
            OpenAI["OpenAI API"]
            Copilot["GitHub Copilot"]
            CustomLLM["Ëá™ÂÆö‰πâLLMÊúçÂä°"]
        end
    end

    %% ÂÆ¢Êà∑Á´Ø
    subgraph Clients["üë• ÂÆ¢Êà∑Á´Ø"]
        Browser["WebÊµèËßàÂô®"]
        DesktopCLI["Ê°åÈù¢CLI"]
        Mobile["ÁßªÂä®Á´Ø"]
        VSCode["VSCodeÊâ©Â±ï"]
    end

    %% ÂºÄÂèëÁéØÂ¢ÉËøûÊé•
    DevCLI -->|HTTP| DevServer
    DevTUI -->|HTTP| DevServer
    DevServer -->|ÂÜÖÈÉ®| DevEventBus
    DevServer -->|WebSocket| DevGateway
    DevGateway -->|ÂÜÖÈÉ®| DevEventBus
    DevEventBus -->|Ê∂àË¥π| DevAgent
    DevAgent -->|Ë∞ÉÁî®| DevLLM
    DevAgent -->|ÊâßË°å| DevTool
    DevSkill -->|Âä†ËΩΩ| DevTool
    
    DevServer -->|ËØªÂèñ| DevConfig
    DevServer -->|Â≠òÂÇ®| DevSessions
    DevSkill -->|Êâ´Êèè| DevSkills
    DevServer -->|ÂÜôÂÖ•| DevLogs
    
    DevLLM -->|Êú¨Âú∞API| DevLocalLLM

    %% Áîü‰∫ßÁéØÂ¢ÉËøûÊé•
    Browser -->|HTTPS| Nginx
    DesktopCLI -->|HTTPS| Nginx
    Mobile -->|HTTPS| Nginx
    VSCode -->|WSS| Nginx
    
    Nginx -->|Ë¥üËΩΩÂùáË°°| Server1
    Nginx -->|Ë¥üËΩΩÂùáË°°| Server2
    Nginx -->|Ë¥üËΩΩÂùáË°°| ServerN
    
    Server1 -->|ËØªÂÜô| Postgres
    Server2 -->|ËØªÂÜô| Postgres
    ServerN -->|ËØªÂÜô| Postgres
    
    Server1 -->|ÁºìÂ≠ò| Redis
    Server2 -->|ÁºìÂ≠ò| Redis
    ServerN -->|ÁºìÂ≠ò| Redis
    
    Server1 -->|Âä†ËΩΩ| ObjectStorage
    Server2 -->|Âä†ËΩΩ| ObjectStorage
    ServerN -->|Âä†ËΩΩ| ObjectStorage
    
    Server1 -->|API| OpenAI
    Server2 -->|API| Copilot
    ServerN -->|API| CustomLLM

    %% Ê†∑ÂºèÂ∫îÁî®
    class DevCLI,DevTUI,DevServer,DevGateway,DevEventBus,DevAgent,DevLLM,DevSkill,DevTool dev
    class DevConfig,DevSessions,DevSkills,DevLogs dev
    class DevLocalLLM external
    class Nginx,Server1,Server2,ServerN prod
    class Postgres,Redis,ObjectStorage prod
    class OpenAI,Copilot,CustomLLM external
    class Browser,DesktopCLI,Mobile,VSCode client
